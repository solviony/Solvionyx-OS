---
dontChroot: false
timeout: 30
script:
  - command: /bin/bash
    args:
      - -c
      - |
        set -e
        
        # Set default timezone - no path validation
        TIMEZONE="America/New_York"
        
        echo "Configuring timezone: $TIMEZONE"
        
        # Remove existing localtime if present
        rm -f /etc/localtime
        
        # Create timezone symlink
        ln -sf "/usr/share/zoneinfo/$TIMEZONE" /etc/localtime
        
        # Write timezone file
        echo "$TIMEZONE" > /etc/timezone
        
        # Configure locale
        echo "LANG=en_US.UTF-8" > /etc/default/locale
        echo "LC_ALL=en_US.UTF-8" >> /etc/default/locale
        
        # Generate locales
        if command -v locale-gen >/dev/null 2>&1; then
          locale-gen en_US.UTF-8
          echo "✓ Locales generated"
        fi
        
        # Set hardware clock
        if command -v hwclock >/dev/null 2>&1; then
          hwclock --systohc --utc || echo "! hwclock failed (running in VM?)"
        fi
        
        echo "✓ Timezone and locale configured: $TIMEZONE"